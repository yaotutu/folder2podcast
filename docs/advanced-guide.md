# 📘 详细使用指南

## 目录
- [文件命名规范](#文件命名规范)
- [配置详解](#配置详解)
- [高级特性](#高级特性)
- [部署方式](#部署方式)
- [API使用说明](#api使用说明)
- [最佳实践](#最佳实践)

## 文件命名规范

### 智能文件名处理

系统支持两种文件命名方式，并根据不同情况智能处理：

#### 1. 带序号的命名方式（推荐）
- 格式1：`数字 + 标题.扩展名`（例如：`01-第一章.mp3`）
- 格式2：`标题 + 数字.扩展名`（例如：`第一集01.mp3`）
- 系统优先使用文件名开头的数字作为剧集编号

#### 2. 不带序号的命名方式
- 直接使用描述性文件名（例如：`简介.mp3`）
- 系统会根据文件的创建时间和大小自动生成唯一的排序值
- 保留完整的文件名作为标题（不含扩展名）

### 标题显示策略

可以通过全局环境变量或每个播客的配置文件来控制标题显示方式：

- **完整模式**（默认）：保留原始文件名（不含扩展名）
  ```bash
  01-简介.mp3    → "01-简介"
  第01期.mp3     → "第01期"
  简介01.mp3     → "简介01"
  ```

- **清理模式**：移除数字和分隔符（仅对带序号的文件有效）
  ```bash
  01-简介.mp3    → "简介"
  第01期.mp3     → "第期"
  简介01.mp3     → "简介"
  ```

## 配置详解

### podcast.json 完整配置项

```json
{
  "title": "播客标题",            // 在播客客户端中显示的标题
  "description": "播客描述",      // 播客简介
  "author": "作者名称",          // 作者信息
  "alias": "podcast-name",      // URL访问的英文标识符（选填）
  "language": "zh-cn",          // 语言代码（RFC 5646标准）
  "category": "科技",           // 播客分类
  "explicit": false,           // 内容分级标记
  "email": "contact@example.com", // 联系邮箱（选填）
  "websiteUrl": "https://example.com", // 相关网站（选填）
  "titleFormat": "full"        // 标题格式：clean或full
}
```

### 配置项详解
- **title/description**：播客的基本展示信息
- **alias**：用于创建易记的URL访问路径，必须是小写字母、数字和连字符的组合
- **language**：遵循 RFC 5646 标准的语言代码（如：zh-cn, en-us）
- **category**：播客分类，影响在客户端中的分类展示
- **explicit**：内容分级标记，用于提示是否包含敏感内容
- **titleFormat**：控制该播客的文件名显示方式，可覆盖全局设置

## 高级特性

### 剧集时间管理

系统根据文件命名方式采用两种不同的时间管理策略：

1. **带序号的文件**：
   - 使用基准日期（2024-12-18）加上序号生成发布时间
   - 序号越小，发布时间越早
   - 例如：`01-简介.mp3` 的发布时间会早于 `02-正文.mp3`

2. **不带序号的文件**：
   - 使用文件的实际创建时间作为发布时间
   - 使用文件创建时间和大小生成唯一的排序值
   - 保持文件的自然时间顺序

### URL访问规范

系统提供两种标准的URL访问方式：

1. 原始路径访问：
```
http://[服务器地址]/audio/[播客目录名]/feed.xml
```

2. 别名路径访问：
```
http://[服务器地址]/audio/[英文别名]/feed.xml
```

## 部署方式

### NPM 部署

1. **环境要求**
   - Node.js 14.0 或更高版本
   - NPM 6.0 或更高版本
   - 准备音频文件目录

2. **安装配置**
   ```bash
   # 克隆项目
   git clone https://github.com/your-repo/folder2podcast.git
   cd folder2podcast

   # 安装依赖
   npm install

   # 配置环境变量（可选）
   export AUDIO_DIR=/path/to/audiobooks
   export PORT=3000
   ```

3. **启动服务**
   ```bash
   # 开发模式
   npm run start:dev

   # 或指定配置启动
   AUDIO_DIR=/path/to/audiobooks PORT=3000 npm run start:dev
   ```

4. **验证服务**
   - 访问管理面板：`http://localhost:3000/podcasts`
   - 确认音频文件可访问
   - 测试播客订阅功能

## API使用说明

### 1. 播客列表接口
- 访问 `/podcasts` 获取所有可用播客列表
- 返回每个播客的详细信息，包括标题、描述、订阅地址等
- 支持中文路径和英文别名双重访问
- Feed URL包含完整的访问地址，可直接用于播客订阅

### 2. 资源访问
- 播客封面：`/audio/播客名称/cover.jpg`
- 音频文件：`/audio/播客名称/episode.mp3`
- 默认资源：`/assets/default-cover.png`

## 最佳实践

### 1. 目录组织
- 每个播客系列独立文件夹
- 使用数字前缀确保正确排序
- 添加清晰的文件描述
- 配置合适的播客信息

### 2. 性能优化
- 控制单个文件夹的文件数量
- 使用英文别名提高兼容性
- 添加合适大小的封面图片（推荐使用正方形图片）

### 3. 安全性
- 使用只读挂载保护音频文件
- 避免在文件名中使用特殊字符
- 定期备份配置文件 